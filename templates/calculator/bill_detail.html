{% extends "base.html" %}

{% block title %}Bill Details - Calculator{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>üìÑ Bill Details</h1>
        <a href="/calculator/bill-history" class="btn btn-secondary">‚Üê Back to History</a>
    </div>

    <div class="bill-info">
        <div class="info-card">
            <h2>{{ bill.bill_name or '(Unnamed Bill)' }}</h2>
            <div class="info-row">
                <span class="label">Created:</span>
                <span class="value">{{ bill.created_at|datetime('%Y-%m-%d %H:%M') }}</span>
            </div>
            <div class="info-row">
                <span class="label">Created By:</span>
                <span class="value">{{ bill.created_by }}</span>
            </div>
            <div class="info-row">
                <span class="label">Total Boxes:</span>
                <span class="value"><strong>{{ bill.total_boxes }}</strong></span>
            </div>
            <div class="info-row">
                <span class="label">Total Price:</span>
                <span class="value">
                    {% if bill.total_price > 0 %}
                        <strong>‚Çπ{{ '%.2f'|format(bill.total_price) }}</strong>
                    {% else %}
                        <span class="text-muted">Price TBD</span>
                    {% endif %}
                </span>
            </div>
        </div>
    </div>

    <div class="bill-items">
        <h3>Items</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Item</th>
                    <th>Type</th>
                    <th>Dimensions</th>
                    <th>Room Size</th>
                    <th>Area</th>
                    <th>Boxes (Exact ‚Üí Needed)</th>
                    <th>Price/Box</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>
                        {{ item.tile_name }}
                        {% if item.product_id %}
                        <a href="/inventory/product/{{ item.product_id }}" target="_blank" class="product-link">üîó</a>
                        {% endif %}
                    </td>
                    <td><span class="badge badge-{{ item.calculation_type }}">{{ item.calculation_type|capitalize }}</span></td>
                    <td>{{ item.dimensions }}</td>
                    <td>{{ item.room_dimensions }}</td>
                    <td>{{ '%.2f'|format(item.area_calculated) }} sq ft</td>
                    <td>{{ '%.2f'|format(item.boxes_exact) }} ‚Üí <strong>{{ item.boxes_needed }}</strong></td>
                    <td>
                        {% if item.price_per_box %}
                            ‚Çπ{{ '%.2f'|format(item.price_per_box) }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>
                        {% if item.total_price %}
                            ‚Çπ{{ '%.2f'|format(item.total_price) }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.bill-info {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 2rem;
}

.info-card h2 {
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #007bff;
}

.info-row {
    display: flex;
    justify-content: space-between;
    padding: 0.75rem 0;
    border-bottom: 1px solid #e0e0e0;
}

.info-row:last-child {
    border-bottom: none;
}

.label {
    font-weight: 500;
}

.value {
    font-weight: 600;
    color: #333;
}

.bill-items {
    background: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.bill-items h3 {
    margin-bottom: 1rem;
}

.table {
    width: 100%;
    border-collapse: collapse;
}

.table th,
.table td {
    padding: 0.75rem;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.table th {
    background: #f8f9fa;
    font-weight: 600;
}

.badge {
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.875rem;
    font-weight: 600;
}

.badge-floor {
    background: #d4edda;
    color: #155724;
}

.badge-wall {
    background: #fff3cd;
    color: #856404;
}

.product-link {
    text-decoration: none;
    font-size: 0.875rem;
}

.text-muted {
    color: #6c757d;
}

.btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s;
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #545b62;
}
</style>
{% endblock %}
