{% extends "base.html" %}

{% block title %}User Management - Admin{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <h1 style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">ğŸ‘¥ User Management</h1>
    <p style="color: #64748b;">Manage user roles and permissions</p>
</div>

<div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="border-bottom: 2px solid #e2e8f0;">
                <th style="padding: 1rem; text-align: left;">Email</th>
                <th style="padding: 1rem; text-align: left;">Role</th>
                <th style="padding: 1rem; text-align: center;">Products</th>
                <th style="padding: 1rem; text-align: center;">Activity</th>
                <th style="padding: 1rem; text-align: left;">Joined</th>
                <th style="padding: 1rem; text-align: right;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr style="border-bottom: 1px solid #e2e8f0;">
                <td style="padding: 1rem;">
                    {{ user.email }}
                    {% if user.id == current_user.id %}
                    <span class="badge" style="background: #dbeafe; color: #1e40af; padding: 0.125rem 0.5rem; border-radius: 9999px; font-size: 0.75rem;">You</span>
                    {% endif %}
                </td>
                <td style="padding: 1rem;">
                    {% if user.role == 'admin' %}
                    <span class="badge-admin" style="background: #fef3c7; color: #92400e; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600;">ADMIN</span>
                    {% else %}
                    <span style="color: #64748b;">User</span>
                    {% endif %}
                </td>
                <td style="padding: 1rem; text-align: center;">{{ user.product_count }}</td>
                <td style="padding: 1rem; text-align: center;">
                    <a href="{{ url_for('admin.user_activity', user_id=user.id) }}" style="color: #3b82f6; text-decoration: none;">{{ user.activity_count }}</a>
                </td>
                <td style="padding: 1rem; color: #64748b; font-size: 0.875rem;">{{ user.created_at }}</td>
                <td style="padding: 1rem; text-align: right;">
                    {% if user.id != current_user.id %}
                        {% if user.role == 'admin' %}
                        <form method="POST" action="{{ url_for('admin.demote_user', user_id=user.id) }}" style="display: inline;">
                            <button type="submit" style="background: #ef4444; color: white; padding: 0.5rem 1rem; border: none; border-radius: 0.375rem; cursor: pointer; font-size: 0.875rem;" onclick="return confirm('Demote this user from admin?')">Demote</button>
                        </form>
                        {% else %}
                        <form method="POST" action="{{ url_for('admin.promote_user', user_id=user.id) }}" style="display: inline;">
                            <button type="submit" style="background: #10b981; color: white; padding: 0.5rem 1rem; border: none; border-radius: 0.375rem; cursor: pointer; font-size: 0.875rem;" onclick="return confirm('Promote this user to admin?')">Promote</button>
                        </form>
                        {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div style="margin-top: 1.5rem;">
    <a href="{{ url_for('admin.dashboard') }}" style="color: #3b82f6; text-decoration: none;">â† Back to Admin Dashboard</a>
</div>
{% endblock %}
